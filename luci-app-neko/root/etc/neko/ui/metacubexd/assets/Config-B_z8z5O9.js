import{b as K,x as ie,u as R,y as Q,o as ce,b3 as oe,i as e,f as l,b4 as M,ai as w,S as L,t as v,z as S,b5 as de,c as Y,d as ee,B as T,F,b6 as ue,q as le,b7 as x,a6 as ge,_ as u,ag as j,b8 as be,b9 as pe,ba as he,bb as ve,bc as fe,bd as me,be as xe,bf as _e,bg as $e,bh as Ce,bi as ke,bj as ye,bk as U,bl as W,bm as Se,bn as we,b2 as Ee,j as Ie,bo as De,bp as Te,bq as Z,br as Le,bs as J,bt as Pe,bu as Ae,bv as Ne,bw as Fe,bx as Be,v as te,g as je,by as Re}from"./index-DEvtqFOl.js";var Ue=v('<div class="flex flex-col p-4">'),Oe=v('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><input type=search name=name class="input input-bordered min-w-0 flex-1"placeholder=google.com><div class="flex items-center gap-2"><select name=type class="select select-bordered"><option>A</option><option>AAAA</option><option>MX'),Me=v("<div class=py-2>"),Qe=v('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),qe=v('<div class="grid grid-cols-2 gap-2 sm:grid-cols-4"><div class=form-control><label for=enable-allow-lan class="label gap-2"><span class=label-text></span></label><input id=enable-allow-lan type=checkbox class=toggle></div><div class=form-control><label for=enable-tun-device class="label gap-2"><span class=label-text></span></label><input id=enable-tun-device type=checkbox class=toggle></div><div class=form-control><label for=tun-ip-stack class="label gap-2"><span class=label-text></span></label><select id=tun-ip-stack class="select select-bordered flex-1"><option>Mixed</option><option>gVisor</option><option>System</option><option>LWIP</option></select></div><div class=form-control><label for=device-name class="label gap-2"><span class=label-text></span></label><input id=device-name class="input input-bordered min-w-0"></div><div class=form-control><label for=interface-name class="label gap-2"><span class=label-text></span></label><input id=interface-name class="input input-bordered min-w-0">'),Ge=v('<div class="flex flex-col gap-4"><select class="select select-bordered"><option></option><option></option><option></option></select><div class="grid grid-cols-2 gap-2 sm:grid-cols-3">'),Ve=v('<div class=form-control><label class=label><span class=label-text></span></label><input type=number class="input input-bordered">'),ze=v('<div class="flex flex-col gap-2"><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><select class="select select-bordered">'),He=v('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle></div><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><div class="py-2 text-center text-lg font-semibold">&nbsp;</div></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle>'),O=v("<option>"),Xe=v('<span class="absolute -right-1 -top-1 flex h-3 w-3"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-info opacity-75"></span><span class="inline-flex h-3 w-3 rounded-full bg-info">'),We=v('<div class="grid grid-cols-2 gap-4"><kbd class=kbd></kbd><div class=relative><kbd class="kbd w-full">'),Ze=v('<div class="mx-auto flex max-w-screen-md flex-col gap-4">');const Je=S.object({name:S.string(),type:S.string()}),Ke=()=>{const[o]=R(),t=de(),{form:f,isSubmitting:g}=Y({extend:te({schema:Je}),onSubmit:s=>t.get("dns/query",{searchParams:{name:s.name,type:s.type}}).json().then(({Answer:a})=>_((a==null?void 0:a.map(({data:n})=>n))||[])).catch(a=>je.error(a.message))}),[c,_]=Q([]);return(()=>{var s=Oe(),a=s.firstChild,n=a.firstChild,$=n.nextSibling;return $.firstChild,ee(f,a,()=>f),e($,l(T,{type:"submit",class:"btn-primary",get loading(){return g()},get children(){return o("dnsQuery")}}),null),e(s,l(L,{get when(){return c().length>0},get children(){var k=Ue();return e(k,l(F,{get each(){return c()},children:E=>(()=>{var y=Me();return e(y,E),y})()})),k}}),null),s})()},Ye=S.object({port:S.number(),"socks-port":S.number(),"redir-port":S.number(),"tproxy-port":S.number(),"mixed-port":S.number()}),el=({backendVersion:o})=>{const[t]=R(),f=[{label:()=>t("port",{name:"Mixed"}),key:"mixed-port",onChange:n=>void x("mixed-port",Number(n.target.value),a)},{label:()=>t("port",{name:"HTTP"}),key:"port",onChange:n=>void x("port",Number(n.target.value),a)},{label:()=>t("port",{name:"Socks"}),key:"socks-port",onChange:n=>void x("socks-port",Number(n.target.value),a)},{label:()=>t("port",{name:"Redir"}),key:"redir-port",onChange:n=>void x("redir-port",Number(n.target.value),a)},{label:()=>t("port",{name:"TProxy"}),key:"tproxy-port",onChange:n=>void x("tproxy-port",Number(n.target.value),a)}],{form:g,setInitialValues:c,reset:_}=Y({extend:te({schema:Ye})}),[s,{refetch:a}]=ue(Re);return le(()=>{const n=s();n&&(c(n),_())}),(()=>{var n=Ge(),$=n.firstChild,k=$.firstChild,E=k.nextSibling,y=E.nextSibling,d=$.nextSibling;return $.addEventListener("change",i=>void x("mode",i.target.value,a)),e(k,()=>t("global")),e(E,()=>t("rule")),e(y,()=>t("direct")),e(n,l(L,{get when(){return!M(o())},get children(){return[(()=>{var i=Qe();return ee(g,i,()=>g),e(i,l(F,{each:f,children:p=>(()=>{var I=Ve(),C=I.firstChild,h=C.firstChild,b=C.nextSibling;return e(h,()=>p.label()),ge(b,"change",p.onChange),u(m=>{var B=p.key,P=p.key,A=p.key,N=p.label();return B!==m.e&&j(C,"for",m.e=B),P!==m.t&&j(b,"id",m.t=P),A!==m.a&&j(b,"name",m.a=A),N!==m.o&&j(b,"placeholder",m.o=N),m},{e:void 0,t:void 0,a:void 0,o:void 0}),I})()})),i})(),(()=>{var i=qe(),p=i.firstChild,I=p.firstChild,C=I.firstChild,h=I.nextSibling,b=p.nextSibling,m=b.firstChild,B=m.firstChild,P=m.nextSibling,A=b.nextSibling,N=A.firstChild,ae=N.firstChild,q=N.nextSibling,G=A.nextSibling,V=G.firstChild,ne=V.firstChild,z=V.nextSibling,re=G.nextSibling,H=re.firstChild,se=H.firstChild,X=H.nextSibling;return e(C,()=>t("allowLan")),h.addEventListener("change",r=>void x("allow-lan",r.target.checked,a)),e(B,()=>t("enableTunDevice")),P.addEventListener("change",r=>void x("tun",{enable:r.target.checked},a)),e(ae,()=>t("tunModeStack")),q.addEventListener("change",r=>void x("tun",{stack:r.target.value},a)),e(ne,()=>t("tunDeviceName")),z.addEventListener("change",r=>void x("tun",{device:r.target.value},a)),e(se,()=>t("interfaceName")),X.addEventListener("change",r=>void x("interface-name",r.target.value,a)),u(()=>{var r;return h.checked=(r=s())==null?void 0:r["allow-lan"]}),u(()=>{var r,D;return P.checked=(D=(r=s())==null?void 0:r.tun)==null?void 0:D.enable}),u(()=>{var r,D;return q.value=(D=(r=s())==null?void 0:r.tun)==null?void 0:D.stack}),u(()=>{var r,D;return z.value=(D=(r=s())==null?void 0:r.tun)==null?void 0:D.device}),u(()=>{var r;return X.value=(r=s())==null?void 0:r["interface-name"]}),i})()]}}),d),e(d,l(T,{class:"btn-primary",get loading(){return be()},onClick:pe,get children(){return t("reloadConfig")}}),null),e(d,l(T,{class:"btn-accent",get loading(){return he()},onClick:ve,get children(){return t("flushFakeIP")}}),null),e(d,l(T,{class:"btn-warning",get loading(){return fe()},onClick:me,get children(){return t("restartCore")}}),null),e(d,l(L,{get when(){return!M(o())},get children(){return[l(T,{class:"btn-secondary",get loading(){return xe()},onClick:_e,get children(){return t("updateGEODatabases")}}),l(T,{class:"btn-info",get loading(){return $e()},onClick:Ce,get children(){return t("upgradeUI")}}),l(T,{class:"btn-error",get loading(){return ke()},onClick:ye,get children(){return t("upgradeCore")}})]}}),null),u(()=>{var i;return $.value=(i=s())==null?void 0:i.mode}),u(()=>k.value=U.Global),u(()=>E.value=U.Rule),u(()=>y.value=U.Direct),n})()},ll=()=>{const[o]=R(),t=K(),f=[{label:()=>o("en"),value:W.EN},{label:()=>o("zh"),value:W.ZH}];return(()=>{var g=He(),c=g.firstChild,_=c.firstChild,s=_.firstChild,a=_.nextSibling,n=a.firstChild,$=a.nextSibling;$.firstChild;var k=c.nextSibling,E=k.firstChild,y=E.firstChild;return e(_,l(w,{get children(){return o("useTwemoji")}}),s),s.addEventListener("change",d=>Se(d.target.checked)),e(a,l(w,{get children(){return o("switchLanguage")}}),n),n.addEventListener("change",d=>we(d.target.value)),e(n,l(F,{each:f,children:d=>(()=>{var i=O();return e(i,()=>d.label()),u(()=>i.selected=Ee()===d.value),u(()=>i.value=d.value),i})()})),e($,l(T,{class:"btn-info",onClick:()=>{Ie(""),t(De.Setup)},get children(){return o("switchEndpoint")}}),null),e(E,l(w,{get children(){return o("autoSwitchTheme")}}),y),y.addEventListener("change",d=>Te(d.target.checked)),e(k,l(L,{get when(){return Z()},get children(){var d=ze(),i=d.firstChild,p=i.firstChild,I=i.nextSibling,C=I.firstChild;return e(i,l(w,{get children(){return o("favDayTheme")}}),p),p.addEventListener("change",h=>Le(h.target.value)),e(p,l(F,{each:J,children:h=>(()=>{var b=O();return b.value=h,e(b,h),b})()})),e(I,l(w,{get children(){return o("favNightTheme")}}),C),C.addEventListener("change",h=>Pe(h.target.value)),e(C,l(F,{each:J,children:h=>(()=>{var b=O();return b.value=h,e(b,h),b})()})),u(()=>p.value=Ae()),u(()=>C.value=Ne()),d}}),null),u(()=>s.checked=Fe()),u(()=>y.checked=Z()),g})()},tl=({backendVersion:o})=>{const[t,f]=Q(!1);return le(async()=>{const g=o();g&&f(await Be(g))}),(()=>{var g=We(),c=g.firstChild,_=c.nextSibling,s=_.firstChild;return e(c,()=>"1.143.5"),e(_,l(L,{get when(){return t()},get children(){return Xe()}}),s),e(s,o),g})()},nl=()=>{const o=K();if(!ie())return o("/setup",{replace:!0}),null;const[t]=R(),[f,g]=Q("");return ce(async()=>{g(await oe())}),(()=>{var c=Ze();return e(c,l(L,{get when(){return!M(f())},get children(){return[l(w,{withDivider:!0,get children(){return t("dnsQuery")}}),l(Ke,{})]}}),null),e(c,l(w,{withDivider:!0,get children(){return t("coreConfig")}}),null),e(c,l(el,{backendVersion:f}),null),e(c,l(w,{withDivider:!0,get children(){return t("xdConfig")}}),null),e(c,l(ll,{}),null),e(c,l(w,{withDivider:!0,get children(){return t("version")}}),null),e(c,l(tl,{backendVersion:f}),null),c})()};export{nl as default};
